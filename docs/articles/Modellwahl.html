<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Modellwahl (Bayes-Faktor, DIC) • bayeskurs</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Modellwahl (Bayes-Faktor, DIC)">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bayeskurs</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">Themen</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://www.bioimg.statistik.uni-muenchen.de">Bioimaging Group</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Modellwahl (Bayes-Faktor, DIC)</h1>
                        <h4 class="author">Volker Schmid</h4>
            
            <h4 class="date">3. Juli 2017</h4>
      
      
      <div class="hidden name"><code>Modellwahl.Rmd</code></div>

    </div>

    
    
<div id="bayes-faktor" class="section level1">
<h1 class="hasAnchor">
<a href="#bayes-faktor" class="anchor"></a>Bayes-Faktor</h1>




<div id="beispiel-brandmeldungen-in-frankville-nc" class="section level2">
<h2 class="hasAnchor">
<a href="#beispiel-brandmeldungen-in-frankville-nc" class="anchor"></a>Beispiel Brandmeldungen in Frankville, NC</h2>
<p><em>Quelle: Jim Albert, LearnBayes Vignette</em></p>
Daten: Anzahl von Brandmeldungen in aufeinanderfolgenden Monaten: <span class="math inline">\(y_1, ..., y_N\)</span>. Modell

<ul>
<li>Prioriannahmen über den Erwartungswert von <span class="math inline">\(y\)</span>: Erwartungswert ist 70, Standardabweichung ist 10.</li>
<li>Unklar: welche Verteilung haben die Daten?</li>
</ul>
</div>
<div id="verschiedene-modellannahmen" class="section level2">
<h2 class="hasAnchor">
<a href="#verschiedene-modellannahmen" class="anchor"></a>Verschiedene Modellannahmen</h2>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(y \sim Po(\theta)\)</span></li>
<li><span class="math inline">\(y \sim N(\theta,12^2)\)</span></li>
<li><span class="math inline">\(y \sim N(\theta, 6^2)\)</span></li>
</ol>
<p>In allen Fällen: <span class="math inline">\(\theta \sim Ga(280, 4)\)</span>. (<span class="math inline">\(E(\theta)=70, sd(\theta)=4.2\)</span>)</p>
</div>
<div id="visueller-vergleich" class="section level2">
<h2 class="hasAnchor">
<a href="#visueller-vergleich" class="anchor"></a>Visueller Vergleich</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">fire.counts &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">75</span>, <span class="dv">88</span>, <span class="dv">84</span>, <span class="dv">99</span>, <span class="dv">79</span>, <span class="dv">68</span>, <span class="dv">86</span>, <span class="dv">109</span>, <span class="dv">73</span>, <span class="dv">85</span>, <span class="dv">101</span>, <span class="dv">85</span>,</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">                 <span class="dv">75</span>, <span class="dv">81</span>, <span class="dv">64</span>, <span class="dv">77</span>, <span class="dv">83</span>, <span class="dv">83</span>, <span class="dv">88</span>, <span class="dv">83</span>, <span class="dv">78</span>, <span class="dv">83</span>, <span class="dv">78</span>, <span class="dv">80</span>,</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">                 <span class="dv">82</span>, <span class="dv">90</span>, <span class="dv">74</span>, <span class="dv">72</span>, <span class="dv">69</span>, <span class="dv">72</span>, <span class="dv">76</span>, <span class="dv">76</span>, <span class="dv">104</span>, <span class="dv">86</span>, <span class="dv">92</span>, <span class="dv">88</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">hist</span>(fire.counts, <span class="dt">probability=</span><span class="ot">TRUE</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.08</span>))</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">x &lt;-<span class="st"> </span><span class="dv">60</span><span class="op">:</span><span class="dv">110</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">lines</span>(x, <span class="kw">dpois</span>(x, <span class="dt">lambda=</span><span class="kw">mean</span>(fire.counts)), <span class="dt">col=</span><span class="st">"red"</span>)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">lines</span>(x, <span class="kw">dnorm</span>(x, <span class="dt">mean=</span><span class="kw">mean</span>(fire.counts), <span class="dt">sd=</span><span class="dv">12</span>), <span class="dt">col=</span><span class="st">"blue"</span>)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">lines</span>(x, <span class="kw">dnorm</span>(x, <span class="dt">mean=</span><span class="kw">mean</span>(fire.counts), <span class="dt">sd=</span><span class="dv">6</span>), <span class="dt">col=</span><span class="st">"green"</span>)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="kw">legend</span>(<span class="st">"topright"</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">"M1: Poisson(theta)"</span>,</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">                            <span class="st">"M2: N(theta, 12)"</span>,</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">                            <span class="st">"M3: N(theta, 6)"</span>),</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>), <span class="dt">lty=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="Modellwahl_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
</div>
<div id="pradiktivemarginale-dichte-von-y" class="section level2">
<h2 class="hasAnchor">
<a href="#pradiktivemarginale-dichte-von-y" class="anchor"></a>Prädiktive/Marginale Dichte von <span class="math inline">\(y\)</span>
</h2>
<p><span class="math display">\[
f(y) = \int \prod_{j=1}^N f(y_j | \theta) g(\theta) d\theta.
\]</span> ## Laplace-Approximation {.allowframebreaks}</p>
<ul>
<li>Berechne Posteriori-Modus</li>
<li>Taylor-Approximation der Log-Likelihood</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">laplace &lt;-<span class="st"> </span><span class="cf">function</span> (logpost, mode, ...) </a>
<a class="sourceLine" id="cb2-2" data-line-number="2">{</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  fit =<span class="st"> </span><span class="kw">optim</span>(mode, logpost, <span class="dt">gr =</span> <span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb2-4" data-line-number="4">    ..., <span class="dt">hessian =</span> <span class="ot">TRUE</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">fnscale =</span> <span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  mode =<span class="st"> </span>fit<span class="op">$</span>par</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">  h =<span class="st"> </span><span class="op">-</span><span class="kw">solve</span>(fit<span class="op">$</span>hessian)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">  p =<span class="st"> </span><span class="kw">length</span>(mode)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">  int =<span class="st"> </span>p<span class="op">/</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi) <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(<span class="kw">det</span>(h)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="st">  </span><span class="kw">logpost</span>(mode, ...)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">  stuff =<span class="st"> </span><span class="kw">list</span>(<span class="dt">mode =</span> mode, <span class="dt">var =</span> h, <span class="dt">int =</span> int,</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">                  <span class="dt">converge =</span> fit<span class="op">$</span>convergence <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">  <span class="kw">return</span>(stuff)</a>
<a class="sourceLine" id="cb2-13" data-line-number="13">}</a></code></pre></div>
</div>
<div id="erstes-modell" class="section level2">
<h2 class="hasAnchor">
<a href="#erstes-modell" class="anchor"></a>Erstes Modell</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">model<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="cf">function</span>(theta, y){</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  <span class="kw">sum</span>(<span class="kw">log</span>(<span class="kw">dpois</span>(y, theta))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">    </span><span class="kw">dgamma</span>(theta, <span class="dt">shape=</span><span class="dv">280</span>, <span class="dt">rate=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">}</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">log.pred<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">laplace</span>(model<span class="fl">.1</span>, <span class="dv">80</span>, fire.counts)<span class="op">$</span>int</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">log.pred<span class="fl">.1</span></a></code></pre></div>
<pre><code>## [1] -131.6253</code></pre>
</div>
<div id="zweites-und-drittes-modell" class="section level2">
<h2 class="hasAnchor">
<a href="#zweites-und-drittes-modell" class="anchor"></a>Zweites und drittes Modell</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">model<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="cf">function</span>(theta, y){</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  <span class="kw">sum</span>(<span class="kw">log</span>(<span class="kw">dnorm</span>(y, theta, <span class="dv">6</span>))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">    </span><span class="kw">dgamma</span>(theta, <span class="dt">shape=</span><span class="dv">280</span>, <span class="dt">rate=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">}</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">model<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="cf">function</span>(theta, y){</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">  <span class="kw">sum</span>(<span class="kw">log</span>(<span class="kw">dnorm</span>(y, theta, <span class="dv">12</span>))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="st">    </span><span class="kw">dgamma</span>(theta, <span class="dt">shape=</span><span class="dv">280</span>, <span class="dt">rate=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">log.pred<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">laplace</span>(model<span class="fl">.2</span>, <span class="dv">80</span>, fire.counts)<span class="op">$</span>int</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">log.pred<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">laplace</span>(model<span class="fl">.3</span>, <span class="dv">80</span>, fire.counts)<span class="op">$</span>int</a></code></pre></div>
</div>
<div id="modellvergleich" class="section level2">
<h2 class="hasAnchor">
<a href="#modellvergleich" class="anchor"></a>Modellvergleich</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">data.frame</span>(<span class="dt">Model=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">log.pred=</span><span class="kw">c</span>(log.pred<span class="fl">.1</span>, log.pred<span class="fl">.2</span>, log.pred<span class="fl">.3</span>))</a></code></pre></div>
<pre><code>##   Model  log.pred
## 1     1 -131.6253
## 2     2 -144.7554
## 3     3 -132.9464</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">exp</span>(log.pred<span class="fl">.1</span> <span class="op">-</span><span class="st"> </span>log.pred<span class="fl">.3</span>)</a></code></pre></div>
<pre><code>## [1] 3.74751</code></pre>
<p>Nach Jeffreys <em>beachtliche Anzeichen</em> für Modell 1 gegenüber Modell 3.</p>
</div>
</div>
<div id="devianz-informationskriterium-dic" class="section level1">
<h1 class="hasAnchor">
<a href="#devianz-informationskriterium-dic" class="anchor"></a>Devianz-Informationskriterium (DIC)</h1>
<div id="informationskriterien" class="section level2">
<h2 class="hasAnchor">
<a href="#informationskriterien" class="anchor"></a>Informationskriterien</h2>
<p>Übliche Informationskriterien (z.B. AIC und BIC) messen die Anpassung plus Anzahl der Parameter. Bei hierarchischen Modellen ist die Anzahl der Parameter jedoch nicht aussagekräftig, insbesondere wenn die Parameter abhängig sind. Deshalb ist die Idee hier, die <em>effektive Anzahl</em> der Parameter zu schätzen.</p>
</div>
<div id="devianz" class="section level2">
<h2 class="hasAnchor">
<a href="#devianz" class="anchor"></a>Devianz</h2>
<p>Der Ausdruck <span class="math display">\[\begin{equation*}
D(y) := -2 \Big( \log \big( p(y|\hat\theta)\big)-\log \big(p(y|\hat\theta_s)\big)\Big)
\end{equation*}\]</span> heißt Devianz</p>
<p>Dabei sind <span class="math inline">\(\hat\theta\)</span> die geschätzen Parameter eines Modells <span class="math inline">\(M\)</span> und <span class="math inline">\(\hat\theta_s\)</span> die geschätzten Parameter in einem saturierten Modell (Daten komplett angepasst). Dies entspricht minus zweimal dem Logarithmus des Likelihoodratios. Manchmal wird auch nur <span class="math inline">\(-2 \log \big( p(y|\hat\theta)\big)\)</span> als Devianz bezeichnet.</p>
</div>
<div id="ma-der-reduktion-der-uberraschung" class="section level2">
<h2 class="hasAnchor">
<a href="#ma-der-reduktion-der-uberraschung" class="anchor"></a>Maß der Reduktion der Überraschung</h2>
<p>Sei <span class="math inline">\(\hat{\theta}\)</span> ein Schätzer für <span class="math inline">\(\theta^{TRUE}\)</span>. Betrachte nun <span class="math display">\[\begin{equation*}
d(y,\theta^{TRUE},\hat{\theta})=-2\log\left(p(y|\theta^{TRUE})\right)+2\log\left(p(y|\hat{\theta})\right)
\end{equation*}\]</span> Dies kann interpretiert werden als <em>Maß der Reduktion der Überraschung</em> oder Unsicherheit aufgrund der Schätzung.</p>
<p>Vorschlag von Spiegelhalter et al.(2002): Benutze Posteriori-Erwartungswert von <span class="math inline">\(d(y,\theta^{TRUE},\hat{\theta})\)</span> als <em>Effektive Anzahl der Parameter</em> im Bayes-Modell.</p>
</div>
<div id="effektive-anzahl-von-parametern" class="section level2">
<h2 class="hasAnchor">
<a href="#effektive-anzahl-von-parametern" class="anchor"></a>Effektive Anzahl von Parametern</h2>
<p><span class="math display">\[\begin{aligned}
E(d(y,\theta^{TRUE},\hat{\theta})&amp;=E(-2\log\left(p(y|\theta^{TRUE})\right))+E(2\log\left(p(y|\hat{\theta})\right))\\
           &amp;=: \widehat{D(\theta)}-D(\hat{\theta}) =: p_D
\end{aligned}
\]</span></p>
<p><span class="math inline">\(p_D\)</span> ist abhängig von</p>
<ul>
<li>den Daten <span class="math inline">\(y\)</span>
</li>
<li>dem Datenmodell</li>
<li>der Priori <span class="math inline">\(p(\theta)\)</span>
</li>
<li>der Wahl des Punktschätzers <span class="math inline">\(\hat\theta\)</span>
</li>
</ul>
</div>
<div id="definition-dic" class="section level2">
<h2 class="hasAnchor">
<a href="#definition-dic" class="anchor"></a>Definition DIC</h2>
<p>Das  ist definiert als <span class="math display">\[
DIC=\widehat{D(\theta)}+p_D
\]</span></p>
<p>Dies entspricht dem Bayesianischen Maß für die Anpassung des Fits plus den Komplexitätsterm <span class="math inline">\(p_D\)</span>.</p>
<p>Es gilt: <span class="math inline">\(\widehat{D(\theta)}=E(D(\theta))=E(-2\log(p(y|\theta)))\)</span> wird kleiner für bessere Anpassung.</p>
</div>
<div id="anmerkungen-dic" class="section level2">
<h2 class="hasAnchor">
<a href="#anmerkungen-dic" class="anchor"></a>Anmerkungen DIC</h2>
<ul>
<li>Bei substantiellem Konflikt zwischen Priori und Daten sowie bei nicht unimodalen Posterioris kann <span class="math inline">\(p_D\)</span> negativ werden.</li>
<li>Falls kein hierarchische Modell vorliegt und alle Prioris komplett spezifiziert sind, gilt</li>
</ul>
<p><span class="math display">\[ AIC=D(\hat{\theta}_{ML})+2\cdot p \]</span></p>
</div>
<div id="berechnung-des-dic-bei-mcmc" class="section level2 allowframebreaks">
<h2 class="hasAnchor">
<a href="#berechnung-des-dic-bei-mcmc" class="anchor"></a>Berechnung des DIC bei MCMC</h2>
<ul>
<li>
<span class="math inline">\(\hat{D(\theta)}\)</span>: In jeder MCMC-Iteration <span class="math inline">\(k\)</span> berechne <span class="math inline">\(D(\theta^{(k)}\)</span> und schätze <span class="math inline">\(\hat{D(\theta)}\)</span> über Mittelwert (Median)</li>
<li>
<span class="math inline">\({D(\hat\theta)}\)</span>: Benutze Punktschätzer (Mittelwert, Median) und setze diesen in <span class="math inline">\(D\)</span> ein (plug-in Schätzer)</li>
</ul>
<p>Poisson-Log-Normal-Modell (Hausübung 1):</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">rw=<span class="dv">1</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">source</span>(<span class="st">"drivers_example_mcmc.R"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">mu&lt;-<span class="kw">array</span>(<span class="dv">0</span>,<span class="kw">c</span>(T,nr.it))</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">D &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>,nr.it)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">sigma&lt;-sigma2.save</a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nr.it)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">     {</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">        mu[,i]=alpha.save[i]<span class="op">+</span>belt<span class="op">*</span>beta.save[i]<span class="op">+</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="st">          </span>gamma.save[,i]<span class="op">+</span>delta.save[,i]</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">        D[i] &lt;-<span class="st"> </span><span class="dv">-2</span><span class="op">*</span><span class="kw">sum</span>(<span class="kw">dnorm</span>(y, <span class="dt">mean=</span>mu[,i], </a>
<a class="sourceLine" id="cb11-9" data-line-number="9">                    <span class="dt">sd=</span><span class="kw">sqrt</span>(sigma[i]),<span class="dt">log=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="kw">plot</span>(<span class="kw">density</span>(D))</a></code></pre></div>
<p><img src="Modellwahl_files/figure-html/deviance1-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">D.theta.hat &lt;-<span class="st"> </span><span class="dv">-2</span><span class="op">*</span><span class="kw">sum</span>(<span class="kw">dnorm</span>(y,<span class="kw">apply</span>(mu,<span class="dv">1</span>,median),</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">                  <span class="kw">sqrt</span>(<span class="kw">median</span>(sigma)),<span class="dt">log=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">D.hat &lt;-<span class="st"> </span><span class="kw">median</span>(D)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">pD &lt;-<span class="st"> </span>D.hat <span class="op">-</span><span class="st"> </span>D.theta.hat</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">(DIC1&lt;-<span class="kw">data.frame</span>(<span class="st">"rw"</span>=<span class="dv">1</span>,<span class="st">"D"</span>=D.hat,<span class="st">"pD"</span>=pD,</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">                                <span class="st">"DIC"</span>=D.hat<span class="op">+</span>pD))</a></code></pre></div>
<pre><code>##   rw        D     pD      DIC
## 1  1 752.5426 29.002 781.5446</code></pre>
<p>Als Vergleichsmodell Zeittrend mit Random Walk zweiter Ordnung als Priori (RW2)</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">rw=<span class="dv">2</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw">source</span>(<span class="st">"drivers_example_mcmc.R"</span>)</a></code></pre></div>
<pre><code>## One iteration takes roughly 0.01 seconds. Estimated total time of 10000 Iterations is 92 seconds.</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">mu2&lt;-<span class="kw">array</span>(<span class="dv">0</span>,<span class="kw">c</span>(T,nr.it))</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">D2 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>,nr.it)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nr.it)</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">     {</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">        mu2[,i]=alpha.save[i]<span class="op">+</span>belt<span class="op">*</span>beta.save[i]<span class="op">+</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="st">                    </span>gamma.save[,i]<span class="op">+</span>delta.save[,i]</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">        D2[i] &lt;-<span class="st"> </span><span class="dv">-2</span><span class="op">*</span><span class="kw">sum</span>(<span class="kw">dnorm</span>(y, <span class="dt">mean=</span>mu2[,i], </a>
<a class="sourceLine" id="cb16-8" data-line-number="8">              <span class="dt">sd=</span><span class="kw">sqrt</span>(sigma2.save[i]),<span class="dt">log=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb16-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb16-10" data-line-number="10">D.theta.hat2 &lt;-<span class="st"> </span><span class="dv">-2</span><span class="op">*</span><span class="kw">sum</span>(<span class="kw">dnorm</span>(y,<span class="kw">apply</span>(mu2,<span class="dv">1</span>,median),</a>
<a class="sourceLine" id="cb16-11" data-line-number="11">              <span class="kw">sqrt</span>(<span class="kw">median</span>(sigma2.save)),<span class="dt">log=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb16-12" data-line-number="12">D.hat2 &lt;-<span class="st"> </span><span class="kw">median</span>(D2)</a>
<a class="sourceLine" id="cb16-13" data-line-number="13">pD2 &lt;-<span class="st"> </span>D.hat2 <span class="op">-</span><span class="st"> </span>D.theta.hat2</a>
<a class="sourceLine" id="cb16-14" data-line-number="14">DIC2&lt;-<span class="kw">data.frame</span>(<span class="st">"rw"</span>=<span class="dv">2</span>,<span class="st">"D"</span>=D.hat2,<span class="st">"pD"</span>=pD2,</a>
<a class="sourceLine" id="cb16-15" data-line-number="15">                                <span class="st">"DIC"</span>=D.hat2<span class="op">+</span>pD2)</a></code></pre></div>
<p>und ohne zeitlichen Trend (0):</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">print</span>(<span class="kw">rbind</span>(DIC3,DIC1,DIC2))</a></code></pre></div>
<pre><code>##   rw        D       pD      DIC
## 1  0 879.8065 15.95161 895.7581
## 2  1 752.5426 29.00200 781.5446
## 3  2 752.5353 30.36039 782.8957</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#bayes-faktor">Bayes-Faktor</a><ul class="nav nav-pills nav-stacked">
<li><a href="#beispiel-brandmeldungen-in-frankville-nc">Beispiel Brandmeldungen in Frankville, NC</a></li>
      <li><a href="#verschiedene-modellannahmen">Verschiedene Modellannahmen</a></li>
      <li><a href="#visueller-vergleich">Visueller Vergleich</a></li>
      <li><a href="#pradiktivemarginale-dichte-von-y">Prädiktive/Marginale Dichte von <span class="math inline">\(y\)</span></a></li>
      <li><a href="#erstes-modell">Erstes Modell</a></li>
      <li><a href="#zweites-und-drittes-modell">Zweites und drittes Modell</a></li>
      <li><a href="#modellvergleich">Modellvergleich</a></li>
      </ul>
</li>
      <li>
<a href="#devianz-informationskriterium-dic">Devianz-Informationskriterium (DIC)</a><ul class="nav nav-pills nav-stacked">
<li><a href="#informationskriterien">Informationskriterien</a></li>
      <li><a href="#devianz">Devianz</a></li>
      <li><a href="#ma-der-reduktion-der-uberraschung">Maß der Reduktion der Überraschung</a></li>
      <li><a href="#effektive-anzahl-von-parametern">Effektive Anzahl von Parametern</a></li>
      <li><a href="#definition-dic">Definition DIC</a></li>
      <li><a href="#anmerkungen-dic">Anmerkungen DIC</a></li>
      <li><a href="#berechnung-des-dic-bei-mcmc">Berechnung des DIC bei MCMC</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Volker Schmid.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
